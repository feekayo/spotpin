/**
 * this route handles all requests for categories
 */
var http = require('http');
var express = require('express');
var router = express.Router();
// var router = require('router');
var app = express();
var url = require('url');
var mongodb = require("mongodb");
var ObjectID = mongodb.ObjectID;
var categories = require('modules/categories');
var mongoose = require('mongoose');
var categories_service = require('models/categories');





// Get Routes

router.get('/categories/:id', function(request, response) {
	response.send(JSON.stringify(categories.query(request.params.id)))
});

router.get('/', function(request, response) {
	var get_params = url.parse(request.url, true).query;
					if (Object.keys(get_params).length == 2) {
						var arg = get_params.arg;
						var value = get_params.value;
						if (arg != '' && value != '' && arg != null
								&& value != null) {
							categories_service.findByArg(categories_service.Category, arg, value, response);
						} else {
							response
									.send('Hmmmm... something\'s not right, Are you sure you specified the URI in the right format?')
						}

					} else if (Object.keys(get_params).length == 0) {
						// response.send('All Results');
						categories_service.list(categories_service.Category,  response);
					} else {
						response
								.send('Hmmmm... something\'s not right, Are you sure you specified the URI in the right format?')
					}

});

//Add New Category
router.post('/new',function(requestBody, response) {
	
	categories_service.create(categories_service.Category, requestBody, response);
});

router.get('/remove/:id', function(requestBody, response) {
	
	categories_service.remove(categories_service.Category, requestBody.params.id, response);
});




module.exports = router;